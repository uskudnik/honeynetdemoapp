<!doctype html>
<html>
<head>
    <title>demo syslog parser</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript">

sample_syslog_data = [
"May 12 14:13:33 neo mdworker[4257]: Unable to talk to lsboxd",
"May 12 14:13:33 neo sandboxd[4258] ([4257]): mdworker(4257) deny mach-lookup com.apple.ls.boxd",
"May 12 14:13:34 neo kernel[0]: Sandbox: sandboxd(4258) deny mach-lookup com.apple.coresymbolicationd",
"May 12 14:14:34 neo mdworker[4260]: Unable to talk to lsboxd",
"May 12 14:14:34 neo sandboxd[4261] ([4260]): mdworker(4260) deny mach-lookup com.apple.ls.boxd",
"May 12 14:14:34 neo kernel[0]: Sandbox: sandboxd(4261) deny mach-lookup com.apple.coresymbolicationd",
]


var rmax = 1500;
var rmin = 10;

var imax = 10;

var identify_components_re = "([A-Z]{1}[a-z]{1,} [0-9]{1,2} [0-9]{2}:[0-9]{2}:[0-9]{2}) ([a-zA-Z]+) ([^:]+):(.+)";

function syslog_parser(line) {
    var components = line.match(identify_components_re);
    var data_elements = components.slice(1,components.length);
    data_elements[0] = new Date(data_elements[0]);
    return data_elements;
}

function randomInt(min, max) {
    return Math.floor(Math.random() * (max - min)) + min;
}

function data_generator() {
    return sample_syslog_data[randomInt(0, sample_syslog_data.length)];
}

syslogFetcher = function(settings) {
    // $.ajax, remote request, probably best with websockets?
    if (typeof settings.repeat === 'number') {
        settings.success(data_generator());
        setTimeout(function(){
            // dbg stuff; lets limit this to 10 interations
            imax--;
            if (imax > 0) {
                syslogFetcher(settings)
            }
        }, settings.repeat); // random: Math.random() * (rmax - rmin) + rmin
    } else {
        settings.success(data_generator());
    }
}

syslogFetcher({
    urls: ['one', 'two', 'three'],
    success: show_in_table,
    repeat: 500,
});

function show_in_table(data) {
    
}



</script>
</head>
<body>

</body>
</html>